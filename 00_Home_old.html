<!DOCTYPE html>
<html lang="en">

    <head>
        <title>Flight Setting Carbon</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="./js/d3.min.js"></script>
        <script src="./js/d3-tip-v6.js"></script>
        <link rel="stylesheet" href="./js/d3-tip.css">
        <script src="https://unpkg.com/flubber@0.3.0"></script>
        <script src="https://unpkg.com/topojson@3"></script>

                <!-- CSS Stylesheets -->
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/bootstrap-icons.css" rel="stylesheet">
        <link href="css/vegas.min.css" rel="stylesheet">
        <link href="css/tooplate-barista.css" rel="stylesheet">
        <link href="css/aboutus_style.css" rel="stylesheet">
        <link rel="stylesheet" href="css/main-styles.css">
        <link rel="stylesheet" href="css/jet-title-styles.css">
        <link rel="stylesheet" href="css/arrow_style.css">
        <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
        
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <link rel="stylesheet" href="css/main-styles.css">

        <style>

            html, body {
            height: 100%;
            scroll-behavior: smooth;
            overflow-y: hidden;
            }

            main {
            height: 100%;
            scroll-snap-type: y mandatory;
            overflow-y: scroll;
            }

            body {
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
            overflow-y: scroll;
            }
            section {
            scroll-snap-align: start;
            height: 100vh;
            }


            section {
            height: 100vh;
            scroll-snap-align: start;
            }

            #interactive-map {
            scroll-snap-align: start; /* ⭐ 取消snap */
            height: auto; /* ⭐ 讓裡面高度自己長 */
            overflow: hidden; /* 外面不要滾動 */
            }

            #interactive-map article {
            height: 100%; /* 這樣還是吃一屏 */
            overflow-y: auto; /* ⭐ 內部可以自己滑 */
            }

            #interactive-map .scrollable-content {
            height: 100%;
            overflow-y: auto; /* 內容內部滑動 */
            }




            * {
                margin: 0;
            }
            .chart {
                width: 100%;
                height: 100vh;
                display: grid;
                grid-template-columns: 1fr;      /* 左 2 右 1，更灵活 */
                grid-template-rows: auto 1fr;       /* 第一行自适应，第二行铺满 */
                background-color: #f4f4f4;

            }

            #map {
            display: flex;
            justify-content: center; /* 水平居中 */
            align-items: center;
            width: 100%;
            height: 100%;
            padding-top: 50px;    /* 如果需要内距，用这里 */
            box-sizing: border-box;
            }

            #map svg {
            width: 100%;
            height: 100%;
            display: block; /* 去掉默认 inline-gap */
            }

            .domain {
                stroke: lightgray;
            }

            body {
                margin: 0;
                box-sizing: content-box;
                z-index:1;
            }
            .title {
                font-size: 45px;
                text-align: center;
                font-weight:lighter;
                font-family:'Montserrat',sans-serif;
                font-weight: bold;
                color:rgb(0, 0, 0);
            }
            
            .maptitle{
                padding-top: 50px;
                font-size: 30px;
                text-align: center;
                font-weight: lighter;
                font-family: 'Montserrat',sans-serif;
                font-weight: bold;
                color: rgb(0, 0, 0);
                margin-top:2%;
                margin-left: 1%;
                

            }

            text {
                fill: gray

            }



            g line {
                stroke: lightgray;
            }

            .right-side-div {
                height: 100vh;
                margin-left:10px;
                margin-top:100px;

            }
            .middleThings{
                width: 50%;
                margin: 0 auto;
            }
            .midHeader{
                background-color:gray;
                margin-top:50px;
                margin-bottom:10px;
                text-align: center;
                color:rgb(255, 255, 255);
                font-size:25px;
                font-family:'Montserrat',sans-serif;
                vertical-align:middle;
                font-weight:bold;
                margin-left:10px;
            }
            .text{
                font-size: 20px;
                text-align: center;
                font-weight:lighter;
                font-family:'Montserrat',sans-serif;
                margin-top:35px;
                margin-bottom:35px;
            }
            .mid-text{
                font-size: 20px;
                font-weight:lighter;
                font-family:'Montserrat',sans-serif;
                margin-top:35px;
                margin-bottom:35px;
                margin-left:10px;
                width:100%;
            }

            .right-side-header{
                background-color:#314563;
                margin-bottom:10px;
                color:rgb(255, 255, 255);
                font-size:15px;
                font-family:'Montserrat',sans-serif;
                font-weight:bold;
            }
            .right-text {
                background-color: #f1f1f1;
                border-left: 2px solid gray;
                font-family:'Montserrat',sans-serif;
                padding: 5px;
            }

            #chartArea {
                display: grid;
                grid-template-columns: 70% 25%;
                height: 99vh;
                overflow-y: auto;
                overflow-x: hidden;
                width: 100%;
                padding-right: 18px;
            }
            #container1 {
                height: 100%;
                width: 100%;
                overflow: hidden;

            }

            .flourish-embed{
                text-align: center;
                width: 100%;
            }

            .rough-box {
                max-width: 500px;
                margin: 0 auto;
                margin-bottom:35px;
                padding: 20px;
                color: rgb(255, 255, 255);
                background-image: paint(rough-painter);
            }
            .rough-box {
                --rough-border-width: 3;
                --rough-fill: rgb(194, 188, 188);
                --rough-fill-weight: 9;
                --rough-fill-style: zigzag;
            }
            .rough-box-title {
                margin: 0 auto;
                margin-top:70px;
                margin-bottom:35px;
                padding: 20px;
                color: rgb(255, 255, 255);
                background-image: paint(rough-painter);
            }
            .rough-box-title {
                --rough-border-width: 3;
                --rough-fill: rgb(219, 219, 219); 
                --rough-fill-weight: 9;
                --rough-fill-style: zigzag;
            }
            .button-container{
                text-align: center;
                margin-bottom: 35px;
            }
            
            
            li{
                float: left;
            }
            ul.navbar li a{
                display: block;
                color: white;
                text-align: center;
                padding: 14px 16px;
                text-decoration: none;
                font-family:'Montserrat',sans-serif;
                font-weight: bold;
            }
            ul.navbar li a:hover{
                color: white  ;
                font-weight: bold;
                background-color: gray;
            }
            .active {
            background-color: #64a19d;
            }


            /* ===============================
            SCROLL STEP INDICATOR
            ================================= */
            .step-indicator {
                position: fixed;
                right: 20px;
                top: 50%;
                transform: translateY(-50%);
                display: flex;
                flex-direction: column;
                gap: 10px;
            }

            .step {
                width: 12px;
                height: 12px;
                border-radius: 50%;
                background-color: #ccc;
                cursor: pointer;
            }

            .step.active {
                background-color: #314563;
            }

            .scroll-down {
                display: inline-block;
                margin-top: 40px;
                font-size: 1.2rem;
                color: #ccc;
                text-decoration: none;
                transition: opacity 0.3s ease;
            }

            .scroll-down:hover {
                opacity: 0.7;
            }

                    /* ===============================
        OVERVIEW SECTION
        ================================= */
            .background-video {
                position: absolute;
                top: 0; left: 0;
                width: 100%;
                height: 100%;
                object-fit: cover;
                z-index: 0;
            }       

            .overlay {
                position: absolute;
                top: 0; left: 0; right: 0; bottom: 0;
                background-color: rgba(0, 0, 0, 0.6);
                z-index: 1;
            }    
        
        
            .overview-section {
                position: flex;
                /* background-image: url('videos/videoplayback.webm'); */
                flex-wrap: wrap;
                background-size: cover;
                background-position: center;
                gap: 40px;
                width: 100%;
                height: 100vh;
                align-items: flex-start;
                padding: 40px 20px;
                overflow: hidden;
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .overview-container {
                position: relative;
                z-index: 2;
                display: flex;
                width: 90%;
                max-width: 1400px;
                gap: 40px;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
            }

            .overview-left {
                flex: 1;
                min-width: 800px;
                height: 500px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            #pie-chart {
                width: 100%;
                height: 100%;
            }

            .overview-right {
                flex: 1;
                min-width: 300px;
            }

            .overview-right h1 {
                font-size: 2.2rem;
                font-weight: 700;
                margin-bottom: 20px;
                font-family: 'Montserrat', sans-serif;
            }

            .overview-right p {
                font-size: 1.1rem;
                line-height: 1.7;
                max-width: 600px;
            }

            @media (max-width: 768px) {
                .overview-container {
                    flex-direction: column;
                    align-items: flex-start;
            }

            .overview-left, .overview-right {
                    width: 100%;
                }
            }


            
        </style>
    </head>

    <body>

        <!-- Top navigation div -->
        <ul class="navbar"></ul>

        <!-- Header Section with Title & Logo and Menu -->
        <div class="header-container"> 
        <!-- Fixed header menu showing current section -->
        <div class="fixed-header-menu">
            <div class="title-logo">              
            </div>
        </div>
        
        <nav class="top-navbar">
            <div class="navbar-container">
                <!-- Logo + Title -->
                <div class="navbar-logo">
                    <img src="images/logo.svg" alt="Logo" class="logo-image">
                    <span class="logo-text">AVIATION NETWORK</span>
                </div>
            
                <!-- Menu -->
                <ul class="navbar-menu">
                    <li><a href="#Home">Home</a></li>
                    <li><a href="#Introduction">Global</a></li>
                    <li><a href="#Global">Europe</a></li>
                    <li><a href="#Europe">City</a></li>
                    <li><a href="#references">References</a></li>
                </ul>
            </div>
            </nav>
            
        </div>


        <!-- Scrollbar indicator for scroll pages -->
        <div class="scrollbar-indicator">
            <ul>
                <li data-target="#Home" class="active"></li>
                <li data-target="#Introduction-1"></li>
                <li data-target="#Introduction-2"></li>
                <li data-target="#Introduction-3"></li>
                <li data-target="#interactive-map"></li>
                <li data-target="#Introduction-4"></li>
            </ul>
        </div>



        <section class="hero-section d-flex justify-content-center align-items-center" id="Home">
        <div class="container">
            <div class="row align-items-center justify-content-center text-center">
                <div class="col-lg-8 col-12">                                
                    <h1 class="jet-title">Jet-Setting Carbon</h1>
                    <h2>The Hidden Link Between Aviation and Climate Change</h2>

                    <div class="flight-path">
                        <span class="flight-dot dot-start"></span>
                        <span class="flight-line"></span>
                        <span class="flight-dot dot-end"></span>
                    </div>

                    <div style="position: absolute; bottom: -200px; left: 0; right: 0; display: flex; justify-content: center; align-items: center; z-index: 10;">
                        <a href="#Introduction" class="section-link smoothscroll" style="display: block; text-align: center;">
                            <svg id="more-arrows" class="more-arrows" style="filter: drop-shadow(0px 0px 8px rgba(255, 255, 255, 0.7));">
                                <polygon class="arrow-top" points="37.6,27.9 1.8,1.3 3.3,0 37.6,25.3 71.9,0 73.7,1.3 "/>
                                <polygon class="arrow-middle" points="37.6,45.8 0.8,18.7 4.4,16.4 37.6,41.2 71.2,16.4 74.5,18.7 "/>
                                <polygon class="arrow-bottom" points="37.6,64 0,36.1 5.1,32.8 37.6,56.8 70.4,32.8 75.5,36.1 "/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>


        <div class="hero-slides">
            <video autoplay loop muted playsinline class="hero-video">
                <source src="videos/private-jet.MOV" type="video/quicktime">
                <source src="videos/private-jet.MOV" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>


        </section>
            <section class="overview-section" id="Introduction-1">
                <!-- 背景影片 -->
            <video autoplay muted loop playsinline class="background-video">
                <source src="videos/videoplayback.webm" type="video/webm">
                Your browser does not support the video tag.
            </video>
            <div class="overlay"></div>
            <div class="overview-container">

                <!-- Left: Interactive Chart Placeholder -->
                <div class="overview-left">
                    <div id="pie-chart"></div> 
                    <div id="slider" style="margin-top: 30px;"></div>
                </div>
            
                <!-- Right: Text Content -->
                <div class="overview-right">
                    <h1>Air transport is a carbon-intensive luxury.</h1>
                    <p>
                    If flying may seem normal to you, remember that it’s not for everyone. 
                    In fact, every year, around 90% of the world’s population does not fly. 
                    <strong>Only 1% of the world’s population accounts for 50% of aviation emissions. </strong>
                    Flying, and flying far, is a habit for only a tiny minority of the world’s population.
                    <br>
                    Currently, aviation accounts for approximately 2.5% of global energy-related CO2 emissions. 
                    While it's a relatively small percentage of the overall emissions, 
                    aviation's growth rate has been faster than other transport sectors like 
                    rail, road, or shipping between 2000 and 2019.
                    </p>
                </div>
            </div>
        </section>

        <section class="overview-section" id="Introduction-2">
                 <!-- 背景影片 -->
                <video autoplay muted loop playsinline class="background-video">
                    <source src="videos/videoplayback.webm" type="video/webm">
                    Your browser does not support the video tag.
                </video>
                <div class="overlay"></div>
                <div class="overview-container">
    
                    <!-- Left: Interactive Chart Placeholder -->
                    <div class="overview-left">
                      <div id="pie-chart"></div> 
                      <div id="slider" style="margin-top: 30px;"></div>
                    </div>
                
                    <!-- Right: Text Content -->
                    <div class="overview-right">
                      <h1>Its emissions may seem modest at 2.5%, but aviation’s true climate impact is twice as large: 5% of global warming.</h1>
                      <p>
                        We often read that aviation is responsible for only 2.5% of greenhouse gas emissions.
                        In reality, <strong>this does not take into account non-CO2 effects.</strong> 
                        Today we know that non-CO2 effects account for between <strong>1/2 and 2/3</strong> of radiative forcing, 
                        which means that the role of commercial aviation accounts for <strong>around 5% of global warming</strong> between 2000 and 2018.
                      </p>
                    </div>
                </div>
        </section>
            
            
        <section class="overview-section" id="Introduction-3">
                <!-- 背景影片 -->
            <video autoplay muted loop playsinline class="background-video">
                <source src="videos/videoplayback.webm" type="video/webm">
                Your browser does not support the video tag.
            </video>
            <div class="overlay"></div>
            <div class="overview-container">

                <!-- Left: Interactive Chart Placeholder -->
                <div class="overview-left">
                    <div id="pie-chart"></div> 
                    <div id="slider" style="margin-top: 30px;"></div>
                </div>
            
                <!-- Right: Text Content -->
                <div class="overview-right">
                    <h1>Title</h1>
                    <p>
                    Intro
                    </p>
                </div>
            </div>
        </section>

















    
        <section class="interactive-map" id="interactive-map">
            <div class="scrollable-content">
                <article>
                    
                    <div id="container1">

                        <section id="chartArea">
                            <section class="chart">

                                <div class="maptitle">
                                    <h>The Carbon Dioxide Emission Map of China, 2017</h>
                                </div>
                                <div id="map">
                                </div>

                            </section>

                            <!-- text -->
                            <section>

                                <div class="right-side-div">
                                    <div class="right-side-header" >
                                        <span style="margin-left:5px;">
                                            Introduction to Distribution Map
                                        </span>
                                    </div>
                                    <p class="right-text">
                                        In this example, regional total emission data was divided by the average emission volume. 
                                        This means that, on the map, the regions emitting more carbon dioxide than average (above 1) 
                                        are shaded in pink, and regions emitting less (below 1) are coloured by green. 
                                        You can move your mouse over each area to see the specific emission ratio.
                                    </p>   
                                </div>

                                <div class="right-side-div">
                                    <div class="right-side-header" >
                                        <span style="margin-left:5px;">
                                            Provincial Map: Spatial Agglomeration Emerged
                                        </span>
                                    </div>
                                    <p class="right-text">
                                        In China, the most developed regions and cities are located in the southern and eastern parts of the country. 
                                        The most developed provinces, like Guangdong and Shanghai, produce relatively more carbon dioxide annually, 
                                        as can be seen in this province boundary map. But some provinces like Inner Mongolia, Shanxi and Heibei, 
                                        located in the North of China, still contain much higher emission levels compared to the average level.
                                    </p>
                                </div>

                                <div class="right-side-div">
                                    <div class="right-side-header" >
                                        <span style="margin-left:5px;">
                                            City Map: Agglomeration and Sporadicity
                                        </span>
                                    </div>
                                    <p class="right-text">
                                        To the left is the cities' boundary map of China. It is coloured by the ratio data, 
                                        like the provincial map. It gives us a more accurate view of which cities contribute more carbon dioxide 
                                        than others. The cities that emit more carbon dioxide than average are clustered in China's North and 
                                        Eastern coastal regions. Some core cities, which contain the circles in the map, usually have higher 
                                        access to resources in the provinces to which they belong. This higher level of resource consumption 
                                        means that they make more elevated levels of emissions when compared to the other cities in the same province. 
                                        A more detailed look at this shows that an irregular distribution pattern emerged.

                                    </p>
                                </div>

                                <div class="right-side-div">
                                    <div class="right-side-header" >
                                        <span style="margin-left:5px;">
                                            Scatter Chart: Spatial Elements Distribution
                                        </span>
                                    </div>
                                    <p class="right-text">
                                        The animation combines the shape transformation of cities, provinces and their core cities into one chart. 
                                        The X-axis shows the ratio of carbon dioxide emission, while the Y-axis shows the provinces. 
                                        The shapes in the chart are positioned by their proportion of carbon dioxide emissions. 
                                        The small, coloured circles denote the cities, and circles without colour are the core cities. 
                                        The more prominent circles are the provinces. As we can see, most of the core cities are distributed to the right 
                                        side of the graph, meaning that these cities have emitted more carbon dioxide. Nine provinces, the bigger circles, 
                                        are above the average level. The Northern provinces, Shandong, Hebei, Inner Mongolia, Henan, Liaoning and Shanxi, 
                                        cover 66.7% of the total emissions.
                                    </p>
                                </div>
                            </section>



                            
                        </section>
                    </div>                
                </article>
            </div>
        </section>



        <section class="overview-section" id="Introduction-4">
            <!-- 背景影片 -->
            <video autoplay muted loop playsinline class="background-video">
                <source src="videos/videoplayback.webm" type="video/webm">
                Your browser does not support the video tag.
            </video>
            <div class="overlay"></div>
            <div class="overview-container">

                <!-- Left: Interactive Chart Placeholder -->
                <div class="overview-left">
                    <div id="pie-chart"></div> 
                    <div id="slider" style="margin-top: 30px;"></div>
                </div>
            
                <!-- Right: Text Content -->
                <div class="overview-right">
                    <h1>Title</h1>
                    <p>
                    Intro
                    </p>
                </div>
            </div>
        </section>





        

        <script src="./js/globalCarbon.js" type="module"></script>

        <script>
            CSS.paintWorklet.addModule('./dist/rough-painter.bundled.js');
        </script>

        <script>
// --- 控制小圓點點選跳轉
const indicators = document.querySelectorAll('.scrollbar-indicator li');

indicators.forEach(indicator => {
    indicator.addEventListener('click', () => {
        const targetId = indicator.getAttribute('data-target');
        const targetSection = document.querySelector(targetId);
        if (targetSection) {
            targetSection.scrollIntoView({ behavior: 'smooth' });
        }
    });
});

// --- sections + 自動跳段滾動控制
let sections = document.querySelectorAll('section');
let currentSection = 0;
let isScrolling = false;

window.addEventListener('wheel', (e) => {
    if (isScrolling) return;

    const interactionMap = document.querySelector('#interactive-map .scrollable-content');
    const isInsideMap = interactionMap.contains(e.target) || interactionMap === e.target;

    if (isInsideMap) return;

    if (e.deltaY > 0) {
        if (currentSection < sections.length - 1) {
            currentSection++;
            scrollToSection();
        }
    } else {
        if (currentSection > 0) {
            currentSection--;
            scrollToSection();
        }
    }
});

function scrollToSection() {
    isScrolling = true;
    const current = sections[currentSection];
    current.scrollIntoView({ behavior: 'smooth' });
    updateIndicator(); // ⭐⭐ 補上
    setTimeout(() => {
        isScrolling = false;
    }, 1000);
}

// --- 更新圓點高亮
function updateIndicator() {
    const currentId = sections[currentSection].getAttribute('id');

    indicators.forEach(indicator => {
        if (indicator.getAttribute('data-target') === `#${currentId}`) {
            indicator.classList.add('active');
        } else {
            indicator.classList.remove('active');
        }
    });
}

// --- 地圖內部滾動控制
const interactionMap = document.querySelector('#interactive-map .scrollable-content');
interactionMap.addEventListener('wheel', function(event) {
    const delta = event.deltaY;
    const atTop = interactionMap.scrollTop === 0;
    const atBottom = Math.abs(interactionMap.scrollHeight - interactionMap.scrollTop - interactionMap.clientHeight) < 2;

    if ((atTop && delta < 0) || (atBottom && delta > 0)) {
        // 頂或底，允許滾出
    } else {
        // 中間阻止
        event.stopPropagation();
        event.preventDefault();
    }
}, { passive: false });

        </script>





    </body>

</html>